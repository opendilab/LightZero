<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Policy &mdash; LightZero 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/style.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Worker" href="../worker/index.html" />
    <link rel="prev" title="StochasticMuZeroModelMLP" href="../model/stochastic_muzero_model_mlp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            LightZero
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/installation/installation_and_quickstart.html">Installation and Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/algos/customize_algos.html">How to Customize Your Algorithms in LightZero?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/envs/customize_envs.html">How to Customize Your Environments in LightZero?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/config/config.html">How to Set Configuration Files in LightZero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/logs/logs.html">LightZero’s Logging and Monitoring System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../agent/index.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../entry/index.html">Entry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/index.html">Envs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mcts/index.html">MCTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Policy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#alphazeropolicy">AlphaZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_simulation_env"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_simulation_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._policy_value_fn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._policy_value_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#muzeropolicy">MuZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">MuZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#efficientzeropolicy">EfficientZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.efficientzero.EfficientZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">EfficientZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gumbel-alphazeropolicy">Gumbel AlphaZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_simulation_env"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_simulation_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._policy_value_fn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._policy_value_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gumbel-muzeropolicy">Gumbel MuZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">GumbelMuZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sampled-alphazeropolicy">Sampled AlphaZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._calculate_policy_loss_disc"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._calculate_policy_loss_disc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_simulation_env"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_simulation_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._policy_value_func"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._policy_value_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sampled-muzeropolicy">Sampled MuZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._calculate_policy_loss_cont"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._calculate_policy_loss_cont()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._calculate_policy_loss_disc"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._calculate_policy_loss_disc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">SampledMuZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sampled-efficientzeropolicy">Sampled EfficientZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._calculate_policy_loss_cont"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._calculate_policy_loss_cont()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._calculate_policy_loss_disc"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._calculate_policy_loss_disc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">SampledEfficientZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stochastic-muzeropolicy">Stochastic MuZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">StochasticMuZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#unizeropolicy">UniZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._get_target_obs_index_in_step_k"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._get_target_obs_index_in_step_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.monitor_weights_and_grads"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.monitor_weights_and_grads()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.recompute_pos_emb_diff_and_clear_cache"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.recompute_pos_emb_diff_and_clear_cache()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.set_train_iter_env_step"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.set_train_iter_env_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">UniZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../worker/index.html">Worker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">LightZero</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">&lt;no title&gt;</a></li>
      <li class="breadcrumb-item active">Policy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api_doc/policy/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
    
    
  <section id="policy">
<h1>Policy<a class="headerlink" href="#policy" title="Permalink to this heading"></a></h1>
<section id="alphazeropolicy">
<h2>AlphaZeroPolicy<a class="headerlink" href="#alphazeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.alphazero.</span></span><span class="sig-name descname"><span class="pre">AlphaZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for AlphaZero.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use real env to execute MCTS search.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature for MCTS search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode, similar to <code class="docutils literal notranslate"><span class="pre">self._forward_collect</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Policy forward function of learn mode (training policy and updating parameters). Forward means             that the policy inputs some training batch data from the replay buffer and then returns the output             result, including various training information such as loss value, policy entropy, q value, priority,             and so on. This method is left to be implemented by the subclass, and more arguments can be added in             <code class="docutils literal notranslate"><span class="pre">data</span></code> item if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The input data used for policy forward, including a batch of                 training samples. For each element in list, the key of the dict is the name of data items and the                 value is the corresponding data. Usually, in the <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code> method, data should be stacked in                 the batch dimension by some utility functions such as <code class="docutils literal notranslate"><span class="pre">default_preprocess_learn</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The training information of policy forward, including some metrics for                 monitoring training such as loss, priority, q value, policy entropy, and some data for next step                 training such as priority. Note the output data item should be Python native scalar rather than                 PyTorch tensor, which is convenient for the outside to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_simulation_env">
<span class="sig-name descname"><span class="pre">_get_simulation_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._get_simulation_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_simulation_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the learn mode of policy, including related attributes and modules. This method will be             called in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method if <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code>. Almost different policies have             its own learn mode, so this method must be overrided in subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be saved and loaded, please refer to the <code class="docutils literal notranslate"><span class="pre">_state_dict_learn</span></code>             and <code class="docutils literal notranslate"><span class="pre">_load_state_dict_learn</span></code> methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be monitored, please refer to the <code class="docutils literal notranslate"><span class="pre">_monitor_vars_learn</span></code> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set some spacial member variables in <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code> method, you’d better name them             with prefix <code class="docutils literal notranslate"><span class="pre">_learn_</span></code> to avoid conflict with other modes, such as <code class="docutils literal notranslate"><span class="pre">self._learn_attr1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._policy_value_fn">
<span class="sig-name descname"><span class="pre">_policy_value_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._policy_value_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._policy_value_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">namedtuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Generate the dict type transition (one timestep) data from policy learning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for collect mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in collecting in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for eval mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in evaluation in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">256,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts':</span> <span class="pre">{'max_moves':</span> <span class="pre">512,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'pb_c_base':</span> <span class="pre">19652,</span> <span class="pre">'pb_c_init':</span> <span class="pre">1.25,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25},</span> <span class="pre">'model':</span> <span class="pre">{'num_channels':</span> <span class="pre">32,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">6)},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'other':</span> <span class="pre">{'replay_buffer':</span> <span class="pre">{'replay_buffer_size':</span> <span class="pre">1000000,</span> <span class="pre">'save_episode':</span> <span class="pre">False}},</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'tensor_float_32':</span> <span class="pre">False,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">500000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'torch_compile':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'value_weight':</span> <span class="pre">1.0,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model type used in this algorithm, which is registered in ModelRegistry.
- import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="muzeropolicy">
<h2>MuZeroPolicy<a class="headerlink" href="#muzeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.muzero.</span></span><span class="sig-name descname"><span class="pre">MuZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><dl class="simple">
<dt>if self._cfg.model.model_type in [“conv”, “mlp”]:</dt><dd><p>The policy class for MuZero.</p>
</dd>
<dt>if self._cfg.model.model_type == [“conv_context”, “mlp_context”]:</dt><dd><p>The policy class for MuZero w/ Context, a variant of MuZero.
This variant retains the same training settings as MuZero but diverges during inference
by employing a k-step recursively predicted latent representation at the root node,
proposed in the UniZero paper <a class="reference external" href="https://arxiv.org/abs/2406.10667">https://arxiv.org/abs/2406.10667</a>.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.
Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>epsilon</strong> (<em>-</em>) – The epsilon of the eps greedy exploration.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>epsilon: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.
Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.
The data is sampled from replay buffer.
The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.
The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._get_target_obs_index_in_step_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._load_state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._reset_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the collector environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._reset_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the evaluator environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy._state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model, target_model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'analysis_dormant_ratio':</span> <span class="pre">False,</span> <span class="pre">'analysis_sim_norm':</span> <span class="pre">False,</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'cal_dormant_ratio':</span> <span class="pre">False,</span> <span class="pre">'collect_with_pure_policy':</span> <span class="pre">False,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_offline':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">200,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'analysis_dormant_ratio':</span> <span class="pre">False,</span> <span class="pre">'analysis_sim_norm':</span> <span class="pre">False,</span> <span class="pre">'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'discrete_action_encoding_type':</span> <span class="pre">'one_hot',</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'harmony_balance':</span> <span class="pre">False,</span> <span class="pre">'image_channel':</span> <span class="pre">1,</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'norm_type':</span> <span class="pre">'BN',</span> <span class="pre">'num_channels':</span> <span class="pre">64,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(4,</span> <span class="pre">96,</span> <span class="pre">96),</span> <span class="pre">'res_connection_in_dynamics':</span> <span class="pre">True,</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">False,</span> <span class="pre">'support_scale':</span> <span class="pre">300},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'num_segments':</span> <span class="pre">8,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">5,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'policy_entropy_weight':</span> <span class="pre">0,</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'reanalyze_noise':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reuse_search':</span> <span class="pre">False,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">0,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'target_update_freq_for_intrinsic_reward':</span> <span class="pre">1000,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_priority':</span> <span class="pre">False,</span> <span class="pre">'use_rnd_model':</span> <span class="pre">False,</span> <span class="pre">'use_ture_chance_label_in_chance_encoder':</span> <span class="pre">False,</span> <span class="pre">'use_wandb':</span> <span class="pre">False,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For MuZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.muzero_model.MuZeroModel</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/muzero.html#MuZeroPolicy.set_train_iter_env_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.muzero.MuZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.muzero.MuZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="efficientzeropolicy">
<h2>EfficientZeroPolicy<a class="headerlink" href="#efficientzeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.efficientzero.</span></span><span class="sig-name descname"><span class="pre">EfficientZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy" title="lzero.policy.muzero.MuZeroPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for EfficientZero proposed in the paper <a class="reference external" href="https://arxiv.org/abs/2111.00210">https://arxiv.org/abs/2111.00210</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.
Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.
Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                      S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                  <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.             The data is sampled from replay buffer.             The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.                 The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._load_state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – the dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the collector environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the evaluator environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy._state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'collect_with_pure_policy':</span> <span class="pre">False,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_offline':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">200,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'lstm_horizon_len':</span> <span class="pre">5,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'discrete_action_encoding_type':</span> <span class="pre">'one_hot',</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'image_channel':</span> <span class="pre">1,</span> <span class="pre">'lstm_hidden_size':</span> <span class="pre">512,</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'norm_type':</span> <span class="pre">'BN',</span> <span class="pre">'observation_shape':</span> <span class="pre">(4,</span> <span class="pre">96,</span> <span class="pre">96),</span> <span class="pre">'res_connection_in_dynamics':</span> <span class="pre">True,</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">True,</span> <span class="pre">'support_scale':</span> <span class="pre">300},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">5,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'reanalyze_noise':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reuse_search':</span> <span class="pre">False,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">2,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_priority':</span> <span class="pre">False,</span> <span class="pre">'use_ture_chance_label_in_chance_encoder':</span> <span class="pre">False,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/efficientzero.html#EfficientZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For EfficientZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.efficientzero_model.EfficientZeroModel</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.efficientzero.EfficientZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.efficientzero.EfficientZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="gumbel-alphazeropolicy">
<h2>Gumbel AlphaZeroPolicy<a class="headerlink" href="#gumbel-alphazeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.gumbel_alphazero.</span></span><span class="sig-name descname"><span class="pre">GumbelAlphaZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for GumbelAlphaZero.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use real env to execute MCTS search.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature for MCTS search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode, similar to <code class="docutils literal notranslate"><span class="pre">self._forward_collect</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Policy forward function of learn mode (training policy and updating parameters). Forward means             that the policy inputs some training batch data from the replay buffer and then returns the output             result, including various training information such as loss value, policy entropy, q value, priority,             and so on. This method is left to be implemented by the subclass, and more arguments can be added in             <code class="docutils literal notranslate"><span class="pre">data</span></code> item if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The input data used for policy forward, including a batch of                 training samples. For each element in list, the key of the dict is the name of data items and the                 value is the corresponding data. Usually, in the <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code> method, data should be stacked in                 the batch dimension by some utility functions such as <code class="docutils literal notranslate"><span class="pre">default_preprocess_learn</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The training information of policy forward, including some metrics for                 monitoring training such as loss, priority, q value, policy entropy, and some data for next step                 training such as priority. Note the output data item should be Python native scalar rather than                 PyTorch tensor, which is convenient for the outside to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_simulation_env">
<span class="sig-name descname"><span class="pre">_get_simulation_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._get_simulation_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_simulation_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the learn mode of policy, including related attributes and modules. This method will be             called in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method if <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code>. Almost different policies have             its own learn mode, so this method must be overrided in subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be saved and loaded, please refer to the <code class="docutils literal notranslate"><span class="pre">_state_dict_learn</span></code>             and <code class="docutils literal notranslate"><span class="pre">_load_state_dict_learn</span></code> methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be monitored, please refer to the <code class="docutils literal notranslate"><span class="pre">_monitor_vars_learn</span></code> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set some spacial member variables in <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code> method, you’d better name them             with prefix <code class="docutils literal notranslate"><span class="pre">_learn_</span></code> to avoid conflict with other modes, such as <code class="docutils literal notranslate"><span class="pre">self._learn_attr1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._policy_value_fn">
<span class="sig-name descname"><span class="pre">_policy_value_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._policy_value_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._policy_value_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">namedtuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Generate the dict type transition (one timestep) data from policy learning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for collect mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in collecting in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for eval mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in evaluation in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">256,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts':</span> <span class="pre">{'action_space_size':</span> <span class="pre">9,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'gumbel_rng':</span> <span class="pre">0.0,</span> <span class="pre">'gumbel_scale':</span> <span class="pre">10.0,</span> <span class="pre">'legal_actions':</span> <span class="pre">None,</span> <span class="pre">'max_moves':</span> <span class="pre">512,</span> <span class="pre">'max_num_considered_actions':</span> <span class="pre">6,</span> <span class="pre">'maxvisit_init':</span> <span class="pre">50,</span> <span class="pre">'num_of_sampled_actions':</span> <span class="pre">2,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'pb_c_base':</span> <span class="pre">19652,</span> <span class="pre">'pb_c_init':</span> <span class="pre">1.25,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'value_scale':</span> <span class="pre">0.1},</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'num_channels':</span> <span class="pre">32,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">6)},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'other':</span> <span class="pre">{'replay_buffer':</span> <span class="pre">{'replay_buffer_size':</span> <span class="pre">1000000,</span> <span class="pre">'save_episode':</span> <span class="pre">False}},</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'tensor_float_32':</span> <span class="pre">False,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">500000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'torch_compile':</span> <span class="pre">False,</span> <span class="pre">'type':</span> <span class="pre">'gumbel_alphazero',</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'value_weight':</span> <span class="pre">1.0,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model type used in this algorithm, which is registered in ModelRegistry.
- import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="gumbel-muzeropolicy">
<h2>Gumbel MuZeroPolicy<a class="headerlink" href="#gumbel-muzeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.gumbel_muzero.</span></span><span class="sig-name descname"><span class="pre">GumbelMuZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy" title="lzero.policy.muzero.MuZeroPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for Gumbel MuZero proposed in the paper <a class="reference external" href="https://openreview.net/forum?id=bERaNdoegnO">https://openreview.net/forum?id=bERaNdoegnO</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.
Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">roots_completed_value</span></code>, <code class="docutils literal notranslate"><span class="pre">improved_policy_probs</span></code>,                 <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.
Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.
The data is sampled from replay buffer.
The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.
The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._load_state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the collector environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the evaluator environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy._state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model, target_model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_offline':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">200,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">True,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'max_num_considered_actions':</span> <span class="pre">4,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'discrete_action_encoding_type':</span> <span class="pre">'one_hot',</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'image_channel':</span> <span class="pre">1,</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'norm_type':</span> <span class="pre">'BN',</span> <span class="pre">'num_channels':</span> <span class="pre">64,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(4,</span> <span class="pre">96,</span> <span class="pre">96),</span> <span class="pre">'res_connection_in_dynamics':</span> <span class="pre">True,</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">False,</span> <span class="pre">'support_scale':</span> <span class="pre">300},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">5,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'reanalyze_noise':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">0,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_priority':</span> <span class="pre">True,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_muzero.html#GumbelMuZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For MuZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.muzero_model.MuZeroModel</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.gumbel_muzero.GumbelMuZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="sampled-alphazeropolicy">
<h2>Sampled AlphaZeroPolicy<a class="headerlink" href="#sampled-alphazeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.sampled_alphazero.</span></span><span class="sig-name descname"><span class="pre">SampledAlphaZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for Sampled AlphaZero.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._calculate_policy_loss_disc">
<span class="sig-name descname"><span class="pre">_calculate_policy_loss_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_probs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sampled_actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_action_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._calculate_policy_loss_disc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._calculate_policy_loss_disc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use real env to execute MCTS search.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature for MCTS search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode, similar to <code class="docutils literal notranslate"><span class="pre">self._forward_collect</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Policy forward function of learn mode (training policy and updating parameters). Forward means             that the policy inputs some training batch data from the replay buffer and then returns the output             result, including various training information such as loss value, policy entropy, q value, priority,             and so on. This method is left to be implemented by the subclass, and more arguments can be added in             <code class="docutils literal notranslate"><span class="pre">data</span></code> item if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The input data used for policy forward, including a batch of                 training samples. For each element in list, the key of the dict is the name of data items and the                 value is the corresponding data. Usually, in the <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code> method, data should be stacked in                 the batch dimension by some utility functions such as <code class="docutils literal notranslate"><span class="pre">default_preprocess_learn</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The training information of policy forward, including some metrics for                 monitoring training such as loss, priority, q value, policy entropy, and some data for next step                 training such as priority. Note the output data item should be Python native scalar rather than                 PyTorch tensor, which is convenient for the outside to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_simulation_env">
<span class="sig-name descname"><span class="pre">_get_simulation_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._get_simulation_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_simulation_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the learn mode of policy, including related attributes and modules. This method will be             called in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method if <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code>. Almost different policies have             its own learn mode, so this method must be overrided in subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be saved and loaded, please refer to the <code class="docutils literal notranslate"><span class="pre">_state_dict_learn</span></code>             and <code class="docutils literal notranslate"><span class="pre">_load_state_dict_learn</span></code> methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be monitored, please refer to the <code class="docutils literal notranslate"><span class="pre">_monitor_vars_learn</span></code> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set some spacial member variables in <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code> method, you’d better name them             with prefix <code class="docutils literal notranslate"><span class="pre">_learn_</span></code> to avoid conflict with other modes, such as <code class="docutils literal notranslate"><span class="pre">self._learn_attr1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._policy_value_func">
<span class="sig-name descname"><span class="pre">_policy_value_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._policy_value_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._policy_value_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">namedtuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Generate the dict type transition (one timestep) data from policy learning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for collect mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in collecting in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for eval mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in evaluation in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">256,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts':</span> <span class="pre">{'action_space_size':</span> <span class="pre">9,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'legal_actions':</span> <span class="pre">None,</span> <span class="pre">'max_moves':</span> <span class="pre">512,</span> <span class="pre">'num_of_sampled_actions':</span> <span class="pre">2,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'pb_c_base':</span> <span class="pre">19652,</span> <span class="pre">'pb_c_init':</span> <span class="pre">1.25,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25},</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'num_channels':</span> <span class="pre">32,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">6)},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'normalize_prob_of_sampled_actions':</span> <span class="pre">False,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'other':</span> <span class="pre">{'replay_buffer':</span> <span class="pre">{'replay_buffer_size':</span> <span class="pre">1000000,</span> <span class="pre">'save_episode':</span> <span class="pre">False}},</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'policy_loss_type':</span> <span class="pre">'cross_entropy',</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'tensor_float_32':</span> <span class="pre">False,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">500000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'torch_compile':</span> <span class="pre">False,</span> <span class="pre">'type':</span> <span class="pre">'alphazero',</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'value_weight':</span> <span class="pre">1.0,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model type used in this algorithm, which is registered in ModelRegistry.
- import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="sampled-muzeropolicy">
<h2>Sampled MuZeroPolicy<a class="headerlink" href="#sampled-muzeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.sampled_muzero.</span></span><span class="sig-name descname"><span class="pre">SampledMuZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy" title="lzero.policy.muzero.MuZeroPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for Sampled MuZero proposed in the paper <a class="reference external" href="https://arxiv.org/abs/2104.06303">https://arxiv.org/abs/2104.06303</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._calculate_policy_loss_cont">
<span class="sig-name descname"><span class="pre">_calculate_policy_loss_cont</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_sampled_actions_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unroll_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._calculate_policy_loss_cont"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._calculate_policy_loss_cont" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Calculate the policy loss for continuous action space.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy_loss</strong> (<em>-</em>) – The policy loss tensor.</p></li>
<li><p><strong>policy_logits</strong> (<em>-</em>) – The policy logits tensor.</p></li>
<li><p><strong>target_policy</strong> (<em>-</em>) – The target policy tensor.</p></li>
<li><p><strong>mask_batch</strong> (<em>-</em>) – The mask tensor.</p></li>
<li><p><strong>child_sampled_actions_batch</strong> (<em>-</em>) – The child sampled actions tensor.</p></li>
<li><p><strong>unroll_step</strong> (<em>-</em>) – The unroll step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The policy loss tensor.
- policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy tensor.
- policy_entropy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy loss tensor.
- target_policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target policy entropy tensor.
- target_sampled_actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target sampled actions tensor.
- mu (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The mu tensor.
- sigma (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The sigma tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>policy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._calculate_policy_loss_disc">
<span class="sig-name descname"><span class="pre">_calculate_policy_loss_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_sampled_actions_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unroll_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._calculate_policy_loss_disc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._calculate_policy_loss_disc" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Calculate the policy loss for discrete action space.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy_loss</strong> (<em>-</em>) – The policy loss tensor.</p></li>
<li><p><strong>policy_logits</strong> (<em>-</em>) – The policy logits tensor.</p></li>
<li><p><strong>target_policy</strong> (<em>-</em>) – The target policy tensor.</p></li>
<li><p><strong>mask_batch</strong> (<em>-</em>) – The mask tensor.</p></li>
<li><p><strong>child_sampled_actions_batch</strong> (<em>-</em>) – The child sampled actions tensor.</p></li>
<li><p><strong>unroll_step</strong> (<em>-</em>) – The unroll step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The policy loss tensor.
- policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy tensor.
- policy_entropy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy loss tensor.
- target_policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target policy entropy tensor.
- target_sampled_actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target sampled actions tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>policy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.
Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.
Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                      S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                  <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.
The data is sampled from replay buffer.
The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.
The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the collector environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the evaluator environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model, target_model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cos_lr_scheduler':</span> <span class="pre">False,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_offline':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">200,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'init_w':</span> <span class="pre">0.003,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.0001,</span> <span class="pre">'lstm_horizon_len':</span> <span class="pre">5,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'action_space_size':</span> <span class="pre">6,</span> <span class="pre">'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'discrete_action_encoding_type':</span> <span class="pre">'one_hot',</span> <span class="pre">'fixed_sigma_value':</span> <span class="pre">0.3,</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'image_channel':</span> <span class="pre">1,</span> <span class="pre">'lstm_hidden_size':</span> <span class="pre">512,</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'norm_type':</span> <span class="pre">'LN',</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(4,</span> <span class="pre">96,</span> <span class="pre">96),</span> <span class="pre">'res_connection_in_dynamics':</span> <span class="pre">True,</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">True,</span> <span class="pre">'sigma_type':</span> <span class="pre">'conditioned',</span> <span class="pre">'support_scale':</span> <span class="pre">300},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'normalize_prob_of_sampled_actions':</span> <span class="pre">False,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">5,</span> <span class="pre">'optim_type':</span> <span class="pre">'AdamW',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">False,</span> <span class="pre">'policy_entropy_weight':</span> <span class="pre">0.005,</span> <span class="pre">'policy_loss_type':</span> <span class="pre">'cross_entropy',</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'reanalyze_noise':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">True,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">2,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_priority':</span> <span class="pre">False,</span> <span class="pre">'use_ture_chance_label_in_chance_encoder':</span> <span class="pre">False,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_muzero.html#SampledMuZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For Sampled MuZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.sampled_muzero_model.SampledMuZeroModel</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_muzero.SampledMuZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.sampled_muzero.SampledMuZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="sampled-efficientzeropolicy">
<h2>Sampled EfficientZeroPolicy<a class="headerlink" href="#sampled-efficientzeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.sampled_efficientzero.</span></span><span class="sig-name descname"><span class="pre">SampledEfficientZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy" title="lzero.policy.muzero.MuZeroPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for Sampled EfficientZero proposed in the paper <a class="reference external" href="https://arxiv.org/abs/2104.06303">https://arxiv.org/abs/2104.06303</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._calculate_policy_loss_cont">
<span class="sig-name descname"><span class="pre">_calculate_policy_loss_cont</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_sampled_actions_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unroll_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._calculate_policy_loss_cont"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._calculate_policy_loss_cont" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Calculate the policy loss for continuous action space.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy_loss</strong> (<em>-</em>) – The policy loss tensor.</p></li>
<li><p><strong>policy_logits</strong> (<em>-</em>) – The policy logits tensor.</p></li>
<li><p><strong>target_policy</strong> (<em>-</em>) – The target policy tensor.</p></li>
<li><p><strong>mask_batch</strong> (<em>-</em>) – The mask tensor.</p></li>
<li><p><strong>child_sampled_actions_batch</strong> (<em>-</em>) – The child sampled actions tensor.</p></li>
<li><p><strong>unroll_step</strong> (<em>-</em>) – The unroll step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The policy loss tensor.
- policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy tensor.
- policy_entropy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy loss tensor.
- target_policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target policy entropy tensor.
- target_sampled_actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target sampled actions tensor.
- mu (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The mu tensor.
- sigma (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The sigma tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>policy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._calculate_policy_loss_disc">
<span class="sig-name descname"><span class="pre">_calculate_policy_loss_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_sampled_actions_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unroll_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._calculate_policy_loss_disc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._calculate_policy_loss_disc" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Calculate the policy loss for discrete action space.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy_loss</strong> (<em>-</em>) – The policy loss tensor.</p></li>
<li><p><strong>policy_logits</strong> (<em>-</em>) – The policy logits tensor.</p></li>
<li><p><strong>target_policy</strong> (<em>-</em>) – The target policy tensor.</p></li>
<li><p><strong>mask_batch</strong> (<em>-</em>) – The mask tensor.</p></li>
<li><p><strong>child_sampled_actions_batch</strong> (<em>-</em>) – The child sampled actions tensor.</p></li>
<li><p><strong>unroll_step</strong> (<em>-</em>) – The unroll step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The policy loss tensor.
- policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy tensor.
- policy_entropy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The policy entropy loss tensor.
- target_policy_entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target policy entropy tensor.
- target_sampled_actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): The target sampled actions tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>policy_loss (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.
Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.
Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                      S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                  <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.
The data is sampled from replay buffer.
The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.
The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._load_state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – the dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the collector environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the evaluator environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy._state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cos_lr_scheduler':</span> <span class="pre">False,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_offline':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">200,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'init_w':</span> <span class="pre">0.003,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.0001,</span> <span class="pre">'lstm_horizon_len':</span> <span class="pre">5,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'action_space_size':</span> <span class="pre">6,</span> <span class="pre">'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'discrete_action_encoding_type':</span> <span class="pre">'one_hot',</span> <span class="pre">'fixed_sigma_value':</span> <span class="pre">0.3,</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'image_channel':</span> <span class="pre">1,</span> <span class="pre">'lstm_hidden_size':</span> <span class="pre">512,</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'norm_type':</span> <span class="pre">'LN',</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(4,</span> <span class="pre">96,</span> <span class="pre">96),</span> <span class="pre">'res_connection_in_dynamics':</span> <span class="pre">True,</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">True,</span> <span class="pre">'sigma_type':</span> <span class="pre">'conditioned',</span> <span class="pre">'support_scale':</span> <span class="pre">300},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'normalize_prob_of_sampled_actions':</span> <span class="pre">False,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">5,</span> <span class="pre">'optim_type':</span> <span class="pre">'AdamW',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">False,</span> <span class="pre">'policy_entropy_weight':</span> <span class="pre">0.005,</span> <span class="pre">'policy_loss_type':</span> <span class="pre">'cross_entropy',</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'reanalyze_noise':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">True,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">2,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_priority':</span> <span class="pre">True,</span> <span class="pre">'use_ture_chance_label_in_chance_encoder':</span> <span class="pre">False,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_efficientzero.html#SampledEfficientZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For Sampled EfficientZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.sampled_efficientzero_model.SampledEfficientZeroModel</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.sampled_efficientzero.SampledEfficientZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="stochastic-muzeropolicy">
<h2>Stochastic MuZeroPolicy<a class="headerlink" href="#stochastic-muzeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.stochastic_muzero.</span></span><span class="sig-name descname"><span class="pre">StochasticMuZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy" title="lzero.policy.muzero.MuZeroPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for Stochastic MuZero proposed in the paper <a class="reference external" href="https://openreview.net/pdf?id=X6D9bAHhBQ1">https://openreview.net/pdf?id=X6D9bAHhBQ1</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.             Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, its shape is <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, its shape is <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.             Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.             The data is sampled from replay buffer.             The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.                 The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._load_state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in             tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the collector environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the observation and action for the evaluator environment.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – List of data ids to reset (not used in this implementation).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy._state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model, target_model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'afterstate_policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'afterstate_value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'analyze_chance_distribution':</span> <span class="pre">False,</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'commitment_loss_weight':</span> <span class="pre">1.0,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_offline':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">200,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'chance_space_size':</span> <span class="pre">2,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'image_channel':</span> <span class="pre">1,</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'num_channels':</span> <span class="pre">64,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(4,</span> <span class="pre">96,</span> <span class="pre">96),</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">False,</span> <span class="pre">'support_scale':</span> <span class="pre">300},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">5,</span> <span class="pre">'optim_type':</span> <span class="pre">'Adam',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">False,</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'reanalyze_noise':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">0,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">100,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_max_priority_for_new_data':</span> <span class="pre">True,</span> <span class="pre">'use_priority':</span> <span class="pre">True,</span> <span class="pre">'use_ture_chance_label_in_chance_encoder':</span> <span class="pre">False,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/stochastic_muzero.html#StochasticMuZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For MuZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.muzero_model.MuZeroModel</span></code>.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.stochastic_muzero.StochasticMuZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="unizeropolicy">
<h2>UniZeroPolicy<a class="headerlink" href="#unizeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.unizero.</span></span><span class="sig-name descname"><span class="pre">UniZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#lzero.policy.muzero.MuZeroPolicy" title="lzero.policy.muzero.MuZeroPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MuZeroPolicy</span></code></a></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for UniZero, official implementation for paper UniZero: Generalized and Efficient Planning
with Scalable LatentWorld Models. UniZero aims to enhance the planning capabilities of reinforcement learning agents
by addressing the limitations found in MuZero-style algorithms, particularly in environments requiring the
capture of long-term dependencies. More details can be found in <a class="reference external" href="https://arxiv.org/abs/2406.10667">https://arxiv.org/abs/2406.10667</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use model to execute MCTS search.
Choosing the action through sampling during the collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature of the policy.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>temperature: <span class="math notranslate nohighlight">\((1, )\)</span>.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode. Use model to execute MCTS search.
Choosing the action with the highest value (argmax) rather than sampling during the eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>-</em>) – The input data, i.e. the observation.</p></li>
<li><p><strong>action_mask</strong> (<em>-</em>) – The action mask, i.e. the action that cannot be selected.</p></li>
<li><p><strong>to_play</strong> (<em>-</em>) – The player to play.</p></li>
<li><p><strong>ready_env_id</strong> (<em>-</em>) – The id of the env that is ready to collect.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>data (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.Tensor</span></code>):</dt><dd><ul>
<li><p>For Atari, <span class="math notranslate nohighlight">\((N, C*S, H, W)\)</span>, where N is the number of collect_env, C is the number of channels,                     S is the number of stacked frames, H is the height of the image, W is the width of the image.</p></li>
<li><p>For lunarlander, <span class="math notranslate nohighlight">\((N, O)\)</span>, where N is the number of collect_env, O is the observation space size.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>action_mask: <span class="math notranslate nohighlight">\((N, action_space_size)\)</span>, where N is the number of collect_env.</p></li>
<li><p>to_play: <span class="math notranslate nohighlight">\((N, 1)\)</span>, where N is the number of collect_env.</p></li>
<li><p>ready_env_id: None</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict type data, the keys including <code class="docutils literal notranslate"><span class="pre">action</span></code>, <code class="docutils literal notranslate"><span class="pre">distributions</span></code>,                 <code class="docutils literal notranslate"><span class="pre">visit_count_distribution_entropy</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">pred_value</span></code>, <code class="docutils literal notranslate"><span class="pre">policy_logits</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for learning policy in learn mode, which is the core of the learning process.
The data is sampled from replay buffer.
The loss is calculated by the loss function and the loss is backpropagated to update the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The data sampled from replay buffer, which is a tuple of tensors.
The first tensor is the current_batch, the second tensor is the target_batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information dict to be logged, which contains                 current learning loss and learning statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>info_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Union[float,</span> <span class="pre">int]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._get_target_obs_index_in_step_k">
<span class="sig-name descname"><span class="pre">_get_target_obs_index_in_step_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._get_target_obs_index_in_step_k" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the begin index and end index of the target obs in step k.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>-</em>) – The current step k.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The begin index of the target obs in step k.
- end_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The end index of the target obs in step k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>beg_index (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="s1">&#39;conv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">image_channel</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">frame_stack_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_target_obs_index_in_step_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Learn mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the learn model, optimizer and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._load_state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process and pack one timestep transition data into a dict, such as &lt;s, a, r, s’, done&gt;. Some policies             need to do some special process and pack its own necessary attributes (e.g. hidden state and logit),             so this method is left to be implemented by the subclass.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The observation of the current timestep.</p></li>
<li><p><strong>policy_output</strong> (<em>-</em>) – The output of the policy network with the observation                 as input. Usually, it contains the action and the logit of the action.</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – The execution result namedtuple returned by the environment step method,                 except all the elements have been transformed into tensor data. Usually, it contains the next obs,                 reward, done, info, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed transition data of the current timestep.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>transition (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_init_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._reset_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This method resets the collection process for a specific environment. It clears caches and memory
when certain conditions are met, ensuring optimal performance. If reset_init_data is True, the initial data
will be reset.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_id</strong> (<em>-</em>) – The ID of the environment to reset. If None or list, the function returns immediately.</p></li>
<li><p><strong>current_steps</strong> (<em>-</em>) – The current step count in the environment. Used to determine
whether to clear caches.</p></li>
<li><p><strong>reset_init_data</strong> (<em>-</em>) – Whether to reset the initial data. If True, the initial data will be reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_init_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._reset_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This method resets the evaluation process for a specific environment. It clears caches and memory
when certain conditions are met, ensuring optimal performance. If reset_init_data is True,
the initial data will be reset.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_id</strong> (<em>-</em>) – The ID of the environment to reset. If None or list, the function returns immediately.</p></li>
<li><p><strong>current_steps</strong> (<em>-</em>) – The current step count in the environment. Used to determine
whether to clear caches.</p></li>
<li><p><strong>reset_init_data</strong> (<em>-</em>) – Whether to reset the initial data. If True, the initial data will be reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy._state_dict_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model, target_model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'action_type':</span> <span class="pre">'fixed_action_space',</span> <span class="pre">'analysis_sim_norm':</span> <span class="pre">False,</span> <span class="pre">'augmentation':</span> <span class="pre">['shift',</span> <span class="pre">'intensity'],</span> <span class="pre">'batch_size':</span> <span class="pre">256,</span> <span class="pre">'battle_mode':</span> <span class="pre">'play_with_bot_mode',</span> <span class="pre">'collect_with_pure_policy':</span> <span class="pre">False,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">True,</span> <span class="pre">'discount_factor':</span> <span class="pre">0.997,</span> <span class="pre">'env_type':</span> <span class="pre">'not_board_games',</span> <span class="pre">'eps':</span> <span class="pre">{'decay':</span> <span class="pre">100000,</span> <span class="pre">'end':</span> <span class="pre">0.05,</span> <span class="pre">'eps_greedy_exploration_in_collect':</span> <span class="pre">False,</span> <span class="pre">'start':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'linear'},</span> <span class="pre">'eval_freq':</span> <span class="pre">2000,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'game_segment_length':</span> <span class="pre">400,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">20,</span> <span class="pre">'gray_scale':</span> <span class="pre">False,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'ignore_done':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.0001,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'analysis_sim_norm':</span> <span class="pre">False,</span> <span class="pre">'bias':</span> <span class="pre">True,</span> <span class="pre">'categorical_distribution':</span> <span class="pre">True,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'frame_stack_num':</span> <span class="pre">1,</span> <span class="pre">'image_channel':</span> <span class="pre">3,</span> <span class="pre">'learn':</span> <span class="pre">{'learner':</span> <span class="pre">{'hook':</span> <span class="pre">{'save_ckpt_after_iter':</span> <span class="pre">10000}}},</span> <span class="pre">'model_type':</span> <span class="pre">'conv',</span> <span class="pre">'norm_type':</span> <span class="pre">'BN',</span> <span class="pre">'num_channels':</span> <span class="pre">64,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">64,</span> <span class="pre">64),</span> <span class="pre">'res_connection_in_dynamics':</span> <span class="pre">True,</span> <span class="pre">'self_supervised_learning_loss':</span> <span class="pre">True,</span> <span class="pre">'support_scale':</span> <span class="pre">50,</span> <span class="pre">'world_model_cfg':</span> <span class="pre">{'action_space_size':</span> <span class="pre">6,</span> <span class="pre">'analysis_dormant_ratio':</span> <span class="pre">False,</span> <span class="pre">'analysis_sim_norm':</span> <span class="pre">False,</span> <span class="pre">'attention':</span> <span class="pre">'causal',</span> <span class="pre">'attn_pdrop':</span> <span class="pre">0.1,</span> <span class="pre">'context_length':</span> <span class="pre">8,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'device':</span> <span class="pre">'cpu',</span> <span class="pre">'dormant_threshold':</span> <span class="pre">0.025,</span> <span class="pre">'embed_dim':</span> <span class="pre">768,</span> <span class="pre">'embed_pdrop':</span> <span class="pre">0.1,</span> <span class="pre">'env_num':</span> <span class="pre">8,</span> <span class="pre">'gamma':</span> <span class="pre">1,</span> <span class="pre">'group_size':</span> <span class="pre">8,</span> <span class="pre">'gru_gating':</span> <span class="pre">False,</span> <span class="pre">'latent_recon_loss_weight':</span> <span class="pre">0.0,</span> <span class="pre">'max_blocks':</span> <span class="pre">10,</span> <span class="pre">'max_cache_size':</span> <span class="pre">5000,</span> <span class="pre">'max_tokens':</span> <span class="pre">20,</span> <span class="pre">'num_heads':</span> <span class="pre">8,</span> <span class="pre">'num_layers':</span> <span class="pre">2,</span> <span class="pre">'obs_type':</span> <span class="pre">'image',</span> <span class="pre">'perceptual_loss_weight':</span> <span class="pre">0.0,</span> <span class="pre">'policy_entropy_weight':</span> <span class="pre">0,</span> <span class="pre">'predict_latent_loss_type':</span> <span class="pre">'group_kl',</span> <span class="pre">'resid_pdrop':</span> <span class="pre">0.1,</span> <span class="pre">'support_size':</span> <span class="pre">101,</span> <span class="pre">'tokens_per_block':</span> <span class="pre">2}},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'monitor_extra_statistics':</span> <span class="pre">True,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'n_episode':</span> <span class="pre">8,</span> <span class="pre">'num_segments':</span> <span class="pre">8,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'num_unroll_steps':</span> <span class="pre">10,</span> <span class="pre">'optim_type':</span> <span class="pre">'AdamW',</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">False,</span> <span class="pre">'policy_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'priority_prob_alpha':</span> <span class="pre">0.6,</span> <span class="pre">'priority_prob_beta':</span> <span class="pre">0.4,</span> <span class="pre">'random_collect_episode_num':</span> <span class="pre">0,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'reward_loss_weight':</span> <span class="pre">1,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'sample_type':</span> <span class="pre">'transition',</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'ssl_loss_weight':</span> <span class="pre">0,</span> <span class="pre">'target_update_freq':</span> <span class="pre">100,</span> <span class="pre">'target_update_freq_for_intrinsic_reward':</span> <span class="pre">1000,</span> <span class="pre">'target_update_theta':</span> <span class="pre">0.05,</span> <span class="pre">'td_steps':</span> <span class="pre">5,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">50000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">50000,</span> <span class="pre">'train_start_after_envsteps':</span> <span class="pre">0,</span> <span class="pre">'transform2string':</span> <span class="pre">False,</span> <span class="pre">'type':</span> <span class="pre">'unizero',</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'use_augmentation':</span> <span class="pre">False,</span> <span class="pre">'use_priority':</span> <span class="pre">False,</span> <span class="pre">'use_rnd_model':</span> <span class="pre">False,</span> <span class="pre">'use_ture_chance_label_in_chance_encoder':</span> <span class="pre">False,</span> <span class="pre">'value_loss_weight':</span> <span class="pre">0.25,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>model name and model import_names.</dt><dd><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The model type used in this algorithm, which is registered in ModelRegistry.</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[str,</span> <span class="pre">List[str]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can define and use customized network model but must obey the same interface definition indicated             by import_names path. For MuZero, <code class="docutils literal notranslate"><span class="pre">lzero.model.unizero_model.MuZeroModel</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.unizero.UniZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.monitor_weights_and_grads">
<span class="sig-name descname"><span class="pre">monitor_weights_and_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy.monitor_weights_and_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.monitor_weights_and_grads" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.recompute_pos_emb_diff_and_clear_cache">
<span class="sig-name descname"><span class="pre">recompute_pos_emb_diff_and_clear_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/unizero.html#UniZeroPolicy.recompute_pos_emb_diff_and_clear_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.recompute_pos_emb_diff_and_clear_cache" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Clear the caches and precompute positional embedding matrices in the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.set_train_iter_env_step">
<span class="sig-name descname"><span class="pre">set_train_iter_env_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_step</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.set_train_iter_env_step" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the train_iter and env_step for the policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_iter</strong> (<em>-</em>) – The train_iter for the policy.</p></li>
<li><p><strong>env_step</strong> (<em>-</em>) – The env_step for the policy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.unizero.UniZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.unizero.UniZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../model/stochastic_muzero_model_mlp.html" class="btn btn-neutral float-left" title="StochasticMuZeroModelMLP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../worker/index.html" class="btn btn-neutral float-right" title="Worker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OpenDILab Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>