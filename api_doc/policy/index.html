<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Policy &mdash; LightZero 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/style.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Worker" href="../worker/index.html" />
    <link rel="prev" title="StochasticMuZeroModelMLP" href="../model/stochastic_muzero_model_mlp.html" />
    <link href="../../_static/css/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            LightZero
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/installation/installation_and_quickstart.html">Installation and Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/algos/customize_algos.html">How to Customize Your Algorithms in LightZero?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/envs/customize_envs.html">How to Customize Your Environments in LightZero?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/config/config.html">How to Set Configuration Files in LightZero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/logs/logs.html">LightZero’s Logging and Monitoring System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../agent/index.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../entry/index.html">Entry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/index.html">Envs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mcts/index.html">MCTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Policy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#alphazeropolicy">AlphaZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_simulation_env"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_simulation_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._policy_value_fn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._policy_value_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.alphazero.AlphaZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">AlphaZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#muzeropolicy">MuZeroPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#efficientzeropolicy">EfficientZeroPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gumbel-alphazeropolicy">Gumbel AlphaZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_simulation_env"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_simulation_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._policy_value_fn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._policy_value_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">GumbelAlphaZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gumbel-muzeropolicy">Gumbel MuZeroPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampled-alphazeropolicy">Sampled AlphaZeroPolicy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._abc_impl"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._abc_impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._calculate_policy_loss_disc"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._calculate_policy_loss_disc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._create_model"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._create_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._forward_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._forward_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._forward_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_attribute"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_batch_size"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_batch_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_episode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_n_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_sample"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_n_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_simulation_env"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_simulation_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_train_sample"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._get_train_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_multi_gpu_setting"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._init_multi_gpu_setting()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._load_state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._load_state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._load_state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._monitor_vars_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._monitor_vars_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._policy_value_func"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._policy_value_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._process_transition"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._process_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._reset_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._reset_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._reset_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._set_attribute"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._set_attribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_collect"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._state_dict_collect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_eval"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._state_dict_eval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_learn"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy._state_dict_learn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.cfg"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.cfg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.collect_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_mode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.collect_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.config"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_config"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_model"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.default_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.eval_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_mode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.eval_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.learn_function</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_mode"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.learn_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.sync_gradients"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.sync_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.total_field"><code class="docutils literal notranslate"><span class="pre">SampledAlphaZeroPolicy.total_field</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sampled-muzeropolicy">Sampled MuZeroPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampled-efficientzeropolicy">Sampled EfficientZeroPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stochastic-muzeropolicy">Stochastic MuZeroPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unizeropolicy">UniZeroPolicy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../worker/index.html">Worker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">LightZero</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">&lt;no title&gt;</a></li>
      <li class="breadcrumb-item active">Policy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api_doc/policy/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
    
    
  <section id="policy">
<h1>Policy<a class="headerlink" href="#policy" title="Permalink to this heading"></a></h1>
<section id="alphazeropolicy">
<h2>AlphaZeroPolicy<a class="headerlink" href="#alphazeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.alphazero.</span></span><span class="sig-name descname"><span class="pre">AlphaZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for AlphaZero.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use real env to execute MCTS search.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature for MCTS search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode, similar to <code class="docutils literal notranslate"><span class="pre">self._forward_collect</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Policy forward function of learn mode (training policy and updating parameters). Forward means             that the policy inputs some training batch data from the replay buffer and then returns the output             result, including various training information such as loss value, policy entropy, q value, priority,             and so on. This method is left to be implemented by the subclass, and more arguments can be added in             <code class="docutils literal notranslate"><span class="pre">data</span></code> item if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The input data used for policy forward, including a batch of                 training samples. For each element in list, the key of the dict is the name of data items and the                 value is the corresponding data. Usually, in the <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code> method, data should be stacked in                 the batch dimension by some utility functions such as <code class="docutils literal notranslate"><span class="pre">default_preprocess_learn</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The training information of policy forward, including some metrics for                 monitoring training such as loss, priority, q value, policy entropy, and some data for next step                 training such as priority. Note the output data item should be Python native scalar rather than                 PyTorch tensor, which is convenient for the outside to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_simulation_env">
<span class="sig-name descname"><span class="pre">_get_simulation_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._get_simulation_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_simulation_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the learn mode of policy, including related attributes and modules. This method will be             called in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method if <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code>. Almost different policies have             its own learn mode, so this method must be overrided in subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be saved and loaded, please refer to the <code class="docutils literal notranslate"><span class="pre">_state_dict_learn</span></code>             and <code class="docutils literal notranslate"><span class="pre">_load_state_dict_learn</span></code> methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be monitored, please refer to the <code class="docutils literal notranslate"><span class="pre">_monitor_vars_learn</span></code> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set some spacial member variables in <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code> method, you’d better name them             with prefix <code class="docutils literal notranslate"><span class="pre">_learn_</span></code> to avoid conflict with other modes, such as <code class="docutils literal notranslate"><span class="pre">self._learn_attr1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._policy_value_fn">
<span class="sig-name descname"><span class="pre">_policy_value_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._policy_value_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._policy_value_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">namedtuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Generate the dict type transition (one timestep) data from policy learning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for collect mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in collecting in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for eval mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in evaluation in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">256,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'gumbel_algo':</span> <span class="pre">False,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts':</span> <span class="pre">{'max_moves':</span> <span class="pre">512,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'pb_c_base':</span> <span class="pre">19652,</span> <span class="pre">'pb_c_init':</span> <span class="pre">1.25,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25},</span> <span class="pre">'model':</span> <span class="pre">{'num_channels':</span> <span class="pre">32,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">6)},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'multi_gpu':</span> <span class="pre">False,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'other':</span> <span class="pre">{'replay_buffer':</span> <span class="pre">{'replay_buffer_size':</span> <span class="pre">1000000,</span> <span class="pre">'save_episode':</span> <span class="pre">False}},</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'tensor_float_32':</span> <span class="pre">False,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">500000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'torch_compile':</span> <span class="pre">False,</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'value_weight':</span> <span class="pre">1.0,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/alphazero.html#AlphaZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model type used in this algorithm, which is registered in ModelRegistry.
- import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.alphazero.AlphaZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.alphazero.AlphaZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="muzeropolicy">
<h2>MuZeroPolicy<a class="headerlink" href="#muzeropolicy" title="Permalink to this heading"></a></h2>
</section>
<section id="efficientzeropolicy">
<h2>EfficientZeroPolicy<a class="headerlink" href="#efficientzeropolicy" title="Permalink to this heading"></a></h2>
</section>
<section id="gumbel-alphazeropolicy">
<h2>Gumbel AlphaZeroPolicy<a class="headerlink" href="#gumbel-alphazeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.gumbel_alphazero.</span></span><span class="sig-name descname"><span class="pre">GumbelAlphaZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for GumbelAlphaZero.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use real env to execute MCTS search.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature for MCTS search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode, similar to <code class="docutils literal notranslate"><span class="pre">self._forward_collect</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Policy forward function of learn mode (training policy and updating parameters). Forward means             that the policy inputs some training batch data from the replay buffer and then returns the output             result, including various training information such as loss value, policy entropy, q value, priority,             and so on. This method is left to be implemented by the subclass, and more arguments can be added in             <code class="docutils literal notranslate"><span class="pre">data</span></code> item if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The input data used for policy forward, including a batch of                 training samples. For each element in list, the key of the dict is the name of data items and the                 value is the corresponding data. Usually, in the <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code> method, data should be stacked in                 the batch dimension by some utility functions such as <code class="docutils literal notranslate"><span class="pre">default_preprocess_learn</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The training information of policy forward, including some metrics for                 monitoring training such as loss, priority, q value, policy entropy, and some data for next step                 training such as priority. Note the output data item should be Python native scalar rather than                 PyTorch tensor, which is convenient for the outside to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_simulation_env">
<span class="sig-name descname"><span class="pre">_get_simulation_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._get_simulation_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_simulation_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the learn mode of policy, including related attributes and modules. This method will be             called in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method if <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code>. Almost different policies have             its own learn mode, so this method must be overrided in subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be saved and loaded, please refer to the <code class="docutils literal notranslate"><span class="pre">_state_dict_learn</span></code>             and <code class="docutils literal notranslate"><span class="pre">_load_state_dict_learn</span></code> methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be monitored, please refer to the <code class="docutils literal notranslate"><span class="pre">_monitor_vars_learn</span></code> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set some spacial member variables in <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code> method, you’d better name them             with prefix <code class="docutils literal notranslate"><span class="pre">_learn_</span></code> to avoid conflict with other modes, such as <code class="docutils literal notranslate"><span class="pre">self._learn_attr1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._policy_value_fn">
<span class="sig-name descname"><span class="pre">_policy_value_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._policy_value_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._policy_value_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">namedtuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Generate the dict type transition (one timestep) data from policy learning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for collect mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in collecting in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for eval mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in evaluation in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">256,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts':</span> <span class="pre">{'action_space_size':</span> <span class="pre">9,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'gumbel_rng':</span> <span class="pre">0.0,</span> <span class="pre">'gumbel_scale':</span> <span class="pre">10.0,</span> <span class="pre">'legal_actions':</span> <span class="pre">None,</span> <span class="pre">'max_moves':</span> <span class="pre">512,</span> <span class="pre">'max_num_considered_actions':</span> <span class="pre">6,</span> <span class="pre">'maxvisit_init':</span> <span class="pre">50,</span> <span class="pre">'num_of_sampled_actions':</span> <span class="pre">2,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'pb_c_base':</span> <span class="pre">19652,</span> <span class="pre">'pb_c_init':</span> <span class="pre">1.25,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25,</span> <span class="pre">'value_scale':</span> <span class="pre">0.1},</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'num_channels':</span> <span class="pre">32,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">6)},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'other':</span> <span class="pre">{'replay_buffer':</span> <span class="pre">{'replay_buffer_size':</span> <span class="pre">1000000,</span> <span class="pre">'save_episode':</span> <span class="pre">False}},</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'tensor_float_32':</span> <span class="pre">False,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">500000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'torch_compile':</span> <span class="pre">False,</span> <span class="pre">'type':</span> <span class="pre">'gumbel_alphazero',</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'value_weight':</span> <span class="pre">1.0,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/gumbel_alphazero.html#GumbelAlphaZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model type used in this algorithm, which is registered in ModelRegistry.
- import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.gumbel_alphazero.GumbelAlphaZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="gumbel-muzeropolicy">
<h2>Gumbel MuZeroPolicy<a class="headerlink" href="#gumbel-muzeropolicy" title="Permalink to this heading"></a></h2>
</section>
<section id="sampled-alphazeropolicy">
<h2>Sampled AlphaZeroPolicy<a class="headerlink" href="#sampled-alphazeropolicy" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lzero.policy.sampled_alphazero.</span></span><span class="sig-name descname"><span class="pre">SampledAlphaZeroPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<dl class="simple">
<dt>Overview:</dt><dd><p>The policy class for Sampled AlphaZero.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize policy instance according to input configures and model. This method will initialize differnent             fields in policy, including <code class="docutils literal notranslate"><span class="pre">learn</span></code>, <code class="docutils literal notranslate"><span class="pre">collect</span></code>, <code class="docutils literal notranslate"><span class="pre">eval</span></code>. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is used to train the             policy, the <code class="docutils literal notranslate"><span class="pre">collect</span></code> field is used to collect data for training, and the <code class="docutils literal notranslate"><span class="pre">eval</span></code> field is used to             evaluate the policy. The <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> is used to specify which field to initialize, if it is None,             then all fields will be initialized.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy. For the default config,                 see the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute and its comments of policy class.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. If it                 is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code> method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field.                 Otherwise, the model will be set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p></li>
<li><p><strong>enable_field</strong> (<em>-</em>) – The field list to initialize. If it is None, then all fields                 will be initialized. Otherwise, only the fields in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code> will be initialized, which is                 beneficial to save resources.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the derived policy class, it should implement the <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_collect</span></code>, <code class="docutils literal notranslate"><span class="pre">_init_eval</span></code>             method to initialize the corresponding field.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._abc_impl" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._calculate_policy_loss_disc">
<span class="sig-name descname"><span class="pre">_calculate_policy_loss_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_probs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sampled_actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_action_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._calculate_policy_loss_disc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._calculate_policy_loss_disc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._create_model">
<span class="sig-name descname"><span class="pre">_create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._create_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create or validate the neural network model according to the input configuration and model.             If the input model is None, then the model will be created according to <code class="docutils literal notranslate"><span class="pre">default_model</span></code>             method and <code class="docutils literal notranslate"><span class="pre">cfg.model</span></code> field. Otherwise, the model will be verified as an instance of             <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and set to the <code class="docutils literal notranslate"><span class="pre">model</span></code> instance created by outside caller.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>-</em>) – The final merged config used to initialize policy.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – The neural network model used to initialize policy. User can refer to                 the default model defined in the corresponding policy to customize its own model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created neural network model. The different modes of policy will                 add distinct wrappers and plugins to the model, which is used to train, collect and evaluate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- RuntimeError</strong> – If the input model is not None and is not an instance of <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for collecting data in collect mode. Use real env to execute MCTS search.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p></li>
<li><p><strong>temperature</strong> (<em>-</em>) – The temperature for MCTS search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The forward function for evaluating the current policy in eval mode, similar to <code class="docutils literal notranslate"><span class="pre">self._forward_collect</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>-</em>) – The dict of obs, the key is env_id and the value is the                 corresponding obs in this timestep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dict of output, the key is env_id and the value is the                 the corresponding policy output in this timestep, including action, probs and so on.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">torch.Tensor]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_learn">
<span class="sig-name descname"><span class="pre">_forward_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._forward_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._forward_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Policy forward function of learn mode (training policy and updating parameters). Forward means             that the policy inputs some training batch data from the replay buffer and then returns the output             result, including various training information such as loss value, policy entropy, q value, priority,             and so on. This method is left to be implemented by the subclass, and more arguments can be added in             <code class="docutils literal notranslate"><span class="pre">data</span></code> item if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – The input data used for policy forward, including a batch of                 training samples. For each element in list, the key of the dict is the name of data items and the                 value is the corresponding data. Usually, in the <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code> method, data should be stacked in                 the batch dimension by some utility functions such as <code class="docutils literal notranslate"><span class="pre">default_preprocess_learn</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The training information of policy forward, including some metrics for                 monitoring training such as loss, priority, q value, policy entropy, and some data for next step                 training such as priority. Note the output data item should be Python native scalar rather than                 PyTorch tensor, which is convenient for the outside to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_attribute">
<span class="sig-name descname"><span class="pre">_get_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to get the attribute of the policy in             different modes.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DI-engine’s policy will first try to access <cite>_get_{name}</cite> method, and then try to access <cite>_{name}</cite>             attribute. If both of them are not found, it will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_batch_size">
<span class="sig-name descname"><span class="pre">_get_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_episode">
<span class="sig-name descname"><span class="pre">_get_n_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_episode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_sample">
<span class="sig-name descname"><span class="pre">_get_n_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_n_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_simulation_env">
<span class="sig-name descname"><span class="pre">_get_simulation_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._get_simulation_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_simulation_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_train_sample">
<span class="sig-name descname"><span class="pre">_get_train_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._get_train_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._get_train_sample" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>For a given trajectory (transitions, a list of transition) data, process it into a list of sample that             can be used for training directly. A train sample can be a processed transition (DQN with nstep TD)             or some multi-timestep transitions (DRQN). This method is usually used in collectors to execute necessary             RL data preprocessing before training, which can help learner amortize revelant time consumption.             In addition, you can also implement this method as an identity function and do the data processing             in <code class="docutils literal notranslate"><span class="pre">self._forward_learn</span></code> method.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transitions</strong> (<em>-</em>) – The trajectory data (a list of transition), each element is                 the same format as the return value of <code class="docutils literal notranslate"><span class="pre">self._process_transition</span></code> method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed train samples, each element is the similar format                 as input transitions, but may contain more data for training, such as nstep reward, advantage, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>samples (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will vectorize <code class="docutils literal notranslate"><span class="pre">process_transition</span></code> and <code class="docutils literal notranslate"><span class="pre">get_train_sample</span></code> method in the following release version.             And the user can customize the this data processing procecure by overriding this two methods and collector             itself</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_collect">
<span class="sig-name descname"><span class="pre">_init_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._init_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Collect mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the collect model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_eval">
<span class="sig-name descname"><span class="pre">_init_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._init_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Evaluate mode init method. Called by <code class="docutils literal notranslate"><span class="pre">self.__init__</span></code>. Initialize the eval model and MCTS utils.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_learn">
<span class="sig-name descname"><span class="pre">_init_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._init_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the learn mode of policy, including related attributes and modules. This method will be             called in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method if <code class="docutils literal notranslate"><span class="pre">learn</span></code> field is in <code class="docutils literal notranslate"><span class="pre">enable_field</span></code>. Almost different policies have             its own learn mode, so this method must be overrided in subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be saved and loaded, please refer to the <code class="docutils literal notranslate"><span class="pre">_state_dict_learn</span></code>             and <code class="docutils literal notranslate"><span class="pre">_load_state_dict_learn</span></code> methods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the member variables that need to be monitored, please refer to the <code class="docutils literal notranslate"><span class="pre">_monitor_vars_learn</span></code> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set some spacial member variables in <code class="docutils literal notranslate"><span class="pre">_init_learn</span></code> method, you’d better name them             with prefix <code class="docutils literal notranslate"><span class="pre">_learn_</span></code> to avoid conflict with other modes, such as <code class="docutils literal notranslate"><span class="pre">self._learn_attr1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_multi_gpu_setting">
<span class="sig-name descname"><span class="pre">_init_multi_gpu_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bp_update_sync</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._init_multi_gpu_setting" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize multi-gpu data parallel training setting, including broadcast model parameters at the beginning             of the training, and prepare the hook function to allreduce the gradients of model parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – The neural network model to be trained.</p></li>
<li><p><strong>bp_update_sync</strong> (<em>-</em>) – Whether to synchronize update the model parameters after allreduce the                 gradients of model parameters. Async update can be parallel in different network layers like pipeline                 so that it can save time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_collect">
<span class="sig-name descname"><span class="pre">_load_state_dict_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy collect mode, such as load pretrained state_dict, auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy collect state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_eval">
<span class="sig-name descname"><span class="pre">_load_state_dict_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy eval mode, such as load auto-recover             checkpoint, or model replica from learner in distributed training scenarios.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy eval state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_learn">
<span class="sig-name descname"><span class="pre">_load_state_dict_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._load_state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Load the state_dict variable into policy learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> (<em>-</em>) – The dict of policy learn state saved before.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to only load some parts of model, you can simply set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument in             load_state_dict to <code class="docutils literal notranslate"><span class="pre">False</span></code>, or refer to <code class="docutils literal notranslate"><span class="pre">ding.torch_utils.checkpoint_helper</span></code> for more             complicated operation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._monitor_vars_learn">
<span class="sig-name descname"><span class="pre">_monitor_vars_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._monitor_vars_learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._monitor_vars_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Register the variables to be monitored in learn mode. The registered variables will be logged in
tensorboard according to the return value <code class="docutils literal notranslate"><span class="pre">_forward_learn</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._policy_value_func">
<span class="sig-name descname"><span class="pre">_policy_value_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Environment</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._policy_value_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._policy_value_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._process_transition">
<span class="sig-name descname"><span class="pre">_process_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">namedtuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy._process_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._process_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Generate the dict type transition (one timestep) data from policy learning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for collect mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in collecting in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for eval mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different environments/episodes in evaluation in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_learn">
<span class="sig-name descname"><span class="pre">_reset_learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._reset_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset some stateful variables for learn mode when necessary, such as the hidden state of RNN or the             memory bank of some special algortihms. If <code class="docutils literal notranslate"><span class="pre">data_id</span></code> is None, it means to reset all the stateful             varaibles. Otherwise, it will reset the stateful variables according to the <code class="docutils literal notranslate"><span class="pre">data_id</span></code>. For example,             different trajectories in <code class="docutils literal notranslate"><span class="pre">data_id</span></code> will have different hidden state in RNN.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_id</strong> (<em>-</em>) – The id of the data, which is used to reset the stateful variables                 specified by <code class="docutils literal notranslate"><span class="pre">data_id</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not mandatory to be implemented. The sub-class can overwrite this method if necessary.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._set_attribute">
<span class="sig-name descname"><span class="pre">_set_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._set_attribute" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>In order to control the access of the policy attributes, we expose different modes to outside rather than             directly use the policy instance. And we also provide a method to set the attribute of the policy in             different modes. And the new attribute will name as <code class="docutils literal notranslate"><span class="pre">_{name}</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>-</em>) – The name of the attribute.</p></li>
<li><p><strong>value</strong> (<em>-</em>) – The value of the attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_collect">
<span class="sig-name descname"><span class="pre">_state_dict_collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_collect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of collect mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover collectors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy collect state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover collectors, sometimes, we can directly shutdown the crashed             collector and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_eval">
<span class="sig-name descname"><span class="pre">_state_dict_eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_eval" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of eval mode, only including model in usual, which is necessary for distributed             training scenarios to auto-recover evaluators.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy eval state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Not all the scenarios need to auto-recover evaluators, sometimes, we can directly shutdown the crashed             evaluator and renew a new one.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_learn">
<span class="sig-name descname"><span class="pre">_state_dict_learn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy._state_dict_learn" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the state_dict of learn mode, usually including model and optimizer.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dict of current policy learn state, for saving and restoring.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state_dict (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.cfg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EasyDict</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.cfg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_train_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'process_transition',</span> <span class="pre">'get_train_sample',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new collect_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new collect_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_train_sample">
<span class="sig-name descname"><span class="pre">get_train_sample</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.get_train_sample" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.process_transition">
<span class="sig-name descname"><span class="pre">process_transition</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.process_transition" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collect_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_function" title="ding.policy.base_policy.collect_function"><span class="pre">collect_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.collect_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of collect mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own collect mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of collect mode of policy, it is a                 namedtuple whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.collect_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_collect</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_collect</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'batch_size':</span> <span class="pre">256,</span> <span class="pre">'collector_env_num':</span> <span class="pre">8,</span> <span class="pre">'cuda':</span> <span class="pre">False,</span> <span class="pre">'evaluator_env_num':</span> <span class="pre">3,</span> <span class="pre">'fixed_temperature_value':</span> <span class="pre">0.25,</span> <span class="pre">'grad_clip_value':</span> <span class="pre">10,</span> <span class="pre">'learning_rate':</span> <span class="pre">0.2,</span> <span class="pre">'manual_temperature_decay':</span> <span class="pre">False,</span> <span class="pre">'mcts':</span> <span class="pre">{'action_space_size':</span> <span class="pre">9,</span> <span class="pre">'continuous_action_space':</span> <span class="pre">False,</span> <span class="pre">'legal_actions':</span> <span class="pre">None,</span> <span class="pre">'max_moves':</span> <span class="pre">512,</span> <span class="pre">'num_of_sampled_actions':</span> <span class="pre">2,</span> <span class="pre">'num_simulations':</span> <span class="pre">50,</span> <span class="pre">'pb_c_base':</span> <span class="pre">19652,</span> <span class="pre">'pb_c_init':</span> <span class="pre">1.25,</span> <span class="pre">'root_dirichlet_alpha':</span> <span class="pre">0.3,</span> <span class="pre">'root_noise_weight':</span> <span class="pre">0.25},</span> <span class="pre">'mcts_ctree':</span> <span class="pre">True,</span> <span class="pre">'model':</span> <span class="pre">{'num_channels':</span> <span class="pre">32,</span> <span class="pre">'num_res_blocks':</span> <span class="pre">1,</span> <span class="pre">'observation_shape':</span> <span class="pre">(3,</span> <span class="pre">6,</span> <span class="pre">6)},</span> <span class="pre">'momentum':</span> <span class="pre">0.9,</span> <span class="pre">'normalize_prob_of_sampled_actions':</span> <span class="pre">False,</span> <span class="pre">'optim_type':</span> <span class="pre">'SGD',</span> <span class="pre">'other':</span> <span class="pre">{'replay_buffer':</span> <span class="pre">{'replay_buffer_size':</span> <span class="pre">1000000,</span> <span class="pre">'save_episode':</span> <span class="pre">False}},</span> <span class="pre">'piecewise_decay_lr_scheduler':</span> <span class="pre">True,</span> <span class="pre">'policy_loss_type':</span> <span class="pre">'cross_entropy',</span> <span class="pre">'replay_ratio':</span> <span class="pre">0.25,</span> <span class="pre">'sampled_algo':</span> <span class="pre">False,</span> <span class="pre">'tensor_float_32':</span> <span class="pre">False,</span> <span class="pre">'threshold_training_steps_for_final_lr':</span> <span class="pre">500000,</span> <span class="pre">'threshold_training_steps_for_final_temperature':</span> <span class="pre">100000,</span> <span class="pre">'torch_compile':</span> <span class="pre">False,</span> <span class="pre">'type':</span> <span class="pre">'alphazero',</span> <span class="pre">'update_per_collect':</span> <span class="pre">None,</span> <span class="pre">'value_weight':</span> <span class="pre">1.0,</span> <span class="pre">'weight_decay':</span> <span class="pre">0.0001}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EasyDict</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_config" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the default config of policy. This method is used to create the default config of policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default config of corresponding policy. For the derived policy class,                 it will recursively merge the default config of base class and its own default config.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will deepcopy the <code class="docutils literal notranslate"><span class="pre">config</span></code> attribute of the class and return the result. So users don’t need             to worry about the modification of the returned config.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_model">
<span class="sig-name descname"><span class="pre">default_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/lzero/policy/sampled_alphazero.html#SampledAlphaZeroPolicy.default_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.default_model" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return this algorithm default model setting for demonstration.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model type used in this algorithm, which is registered in ModelRegistry.
- import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The model class path list used in this algorithm.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>model_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new eval_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new eval_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_function" title="ding.policy.base_policy.eval_function"><span class="pre">eval_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.eval_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of eval mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different mode. Moreover, derived             subclass can override the interfaces to customize its own eval mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of eval mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.eval_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_eval</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference_output</span> <span class="o">=</span> <span class="n">policy_eval</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">next_obs</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">inference_output</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._asdict">
<span class="sig-name descname"><span class="pre">_asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._asdict" title="Permalink to this definition"></a></dt>
<dd><p>Return a new dict which maps field names to their values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._field_defaults">
<span class="sig-name descname"><span class="pre">_field_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._field_defaults" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._fields">
<span class="sig-name descname"><span class="pre">_fields</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('forward',</span> <span class="pre">'reset',</span> <span class="pre">'info',</span> <span class="pre">'monitor_vars',</span> <span class="pre">'get_attribute',</span> <span class="pre">'set_attribute',</span> <span class="pre">'state_dict',</span> <span class="pre">'load_state_dict')</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._fields" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._make">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._make" title="Permalink to this definition"></a></dt>
<dd><p>Make a new learn_function object from a sequence or iterable</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._replace">
<span class="sig-name descname"><span class="pre">_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function._replace" title="Permalink to this definition"></a></dt>
<dd><p>Return a new learn_function object replacing specified fields with new values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.count" title="Permalink to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.forward" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.get_attribute">
<span class="sig-name descname"><span class="pre">get_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.get_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.index" title="Permalink to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.info" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.load_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.monitor_vars">
<span class="sig-name descname"><span class="pre">monitor_vars</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.monitor_vars" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.reset" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.set_attribute">
<span class="sig-name descname"><span class="pre">set_attribute</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.set_attribute" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function.state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_function" title="ding.policy.base_policy.learn_function"><span class="pre">learn_function</span></a></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.learn_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the interfaces of learn mode of policy, which is used to train the model. Here we use namedtuple             to define immutable interfaces and restrict the usage of policy in different modes. Moreover, derived             subclass can override the interfaces to customize its own learn mode.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interfaces of learn mode of policy, it is a namedtuple                 whose values of distinct fields are different internal methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>interfaces (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Policy.learn_function</span></code>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy_learn</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_output</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">policy_learn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.sync_gradients">
<span class="sig-name descname"><span class="pre">sync_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.sync_gradients" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Synchronize (allreduce) gradients of model parameters in data-parallel multi-gpu training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>-</em>) – The model to synchronize gradients.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used in multi-gpu training, and it should be called after <code class="docutils literal notranslate"><span class="pre">backward</span></code> method and             before <code class="docutils literal notranslate"><span class="pre">step</span></code> method. The user can also use <code class="docutils literal notranslate"><span class="pre">bp_update_sync</span></code> config to control whether to synchronize             gradients allreduce and optimizer updates.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.total_field">
<span class="sig-name descname"><span class="pre">total_field</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'collect',</span> <span class="pre">'eval',</span> <span class="pre">'learn'}</span></em><a class="headerlink" href="#lzero.policy.sampled_alphazero.SampledAlphaZeroPolicy.total_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="sampled-muzeropolicy">
<h2>Sampled MuZeroPolicy<a class="headerlink" href="#sampled-muzeropolicy" title="Permalink to this heading"></a></h2>
</section>
<section id="sampled-efficientzeropolicy">
<h2>Sampled EfficientZeroPolicy<a class="headerlink" href="#sampled-efficientzeropolicy" title="Permalink to this heading"></a></h2>
</section>
<section id="stochastic-muzeropolicy">
<h2>Stochastic MuZeroPolicy<a class="headerlink" href="#stochastic-muzeropolicy" title="Permalink to this heading"></a></h2>
</section>
<section id="unizeropolicy">
<h2>UniZeroPolicy<a class="headerlink" href="#unizeropolicy" title="Permalink to this heading"></a></h2>
</section>
</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../model/stochastic_muzero_model_mlp.html" class="btn btn-neutral float-left" title="StochasticMuZeroModelMLP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../worker/index.html" class="btn btn-neutral float-right" title="Worker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OpenDILab Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>