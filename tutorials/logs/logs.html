<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LightZero’s Logging and Monitoring System &mdash; LightZero 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/style.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="../../api_doc/index.html" />
    <link rel="prev" title="How to Set Configuration Files in LightZero" href="../config/config.html" />
    <link href="../../_static/css/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            LightZero
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/installation_and_quickstart.html">Installation and Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algos/customize_algos.html">How to Customize Your Algorithms in LightZero?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envs/customize_envs.html">How to Customize Your Environments in LightZero?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/config.html">How to Set Configuration Files in LightZero</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">LightZero’s Logging and Monitoring System</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#file-directory-structure">File Directory Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#log-file-analysis">Log File Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#collector-logs">Collector Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluator-logs">Evaluator Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#learner-logs">Learner Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensorboard-log-files">Tensorboard Log Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#checkpoint-files">Checkpoint Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/agent/index.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/config/index.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/entry/index.html">Entry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/envs/index.html">Envs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/mcts/index.html">MCTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/model/index.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/policy/index.html">Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/worker/index.html">Worker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">LightZero</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">LightZero’s Logging and Monitoring System</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/logs/logs.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
    
    
  <section id="lightzero-s-logging-and-monitoring-system">
<h1>LightZero’s Logging and Monitoring System<a class="headerlink" href="#lightzero-s-logging-and-monitoring-system" title="Permalink to this heading"></a></h1>
<p>LightZero is a powerful MCTS and reinforcement learning framework that generates comprehensive log files and model checkpoints during the training process. In this article, we will take an in-depth look at LightZero’s logging and monitoring system, focusing on the file directory structure after running the framework and the contents of each log file.</p>
<section id="file-directory-structure">
<h2>File Directory Structure<a class="headerlink" href="#file-directory-structure" title="Permalink to this heading"></a></h2>
<p>When we conduct an experiment using LightZero, such as training a MuZero agent in the CartPole environment, the framework organizes the output files as follows:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>cartpole_muzero
├── ckpt
│   ├── ckpt_best.pth.tar
│   ├── iteration_0.pth.tar
│   └── iteration_10000.pth.tar
├── log  
│   ├── buffer
│   │   └── buffer_logger.txt
│   ├── collector
│   │   └── collector_logger.txt
│   ├── evaluator
│   │   └── evaluator_logger.txt
│   ├── learner
│   │   └── learner_logger.txt
│   └── serial
│       └── events.out.tfevents.1626453528.CN0014009700M.local
├── formatted_total_config.py
└── total_config.py
</pre></div>
</div>
<p>As we can see, the main body of the output files consists of two folders: <code class="docutils literal notranslate"><span class="pre">log</span></code> and <code class="docutils literal notranslate"><span class="pre">ckpt</span></code>, which store detailed log information and model checkpoints, respectively. The <code class="docutils literal notranslate"><span class="pre">total_config.py</span></code> and <code class="docutils literal notranslate"><span class="pre">formatted_total_config.py</span></code> files record the configuration information for this experiment. For more details on their specific meanings, please refer to the <a class="reference external" href="https://di-engine-docs.readthedocs.io/en/latest/03_system/config.html">Configuration System Documentation</a>.</p>
</section>
<section id="log-file-analysis">
<h2>Log File Analysis<a class="headerlink" href="#log-file-analysis" title="Permalink to this heading"></a></h2>
<section id="collector-logs">
<h3>Collector Logs<a class="headerlink" href="#collector-logs" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">log/collector/collector_logger.txt</span></code> file records various metrics of the collector’s interaction with the environment during the current collection stage, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">episode_count</span></code>: The number of episodes collected in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">envstep_count</span></code>: The number of environment interaction steps collected in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avg_envstep_per_episode</span></code>: The average number of environment interaction steps per episode</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avg_envstep_per_sec</span></code>: The average number of environment interaction steps collected per second</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avg_episode_per_sec</span></code>: The average number of episodes collected per second</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">collect_time</span></code>: The total time spent on data collection in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_mean</span></code>: The average reward obtained during the collection process in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_std</span></code>: The standard deviation of rewards collected in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_max</span></code>: The maximum single reward collected in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_min</span></code>: The minimum single reward collected in this stage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_envstep_count</span></code>: The cumulative total number of environment interaction steps collected by the collector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_episode_count</span></code>: The cumulative total number of episodes collected by the collector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_duration</span></code>: The total running time of the collector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">visit_entropy</span></code>: The entropy of the visit distribution at the root node in MCTS, measuring the uniformity of node visits</p></li>
</ul>
</section>
<section id="evaluator-logs">
<h3>Evaluator Logs<a class="headerlink" href="#evaluator-logs" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">log/evaluator/evaluator_logger.txt</span></code> file records various metrics of the evaluator’s interaction with the environment during the current evaluation stage, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[INFO]</span></code>: Log prompts for each completed episode by the evaluator, including the final reward and current episode count</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train_iter</span></code>: The number of completed training iterations of the model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ckpt_name</span></code>: The path of the model checkpoint used in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">episode_count</span></code>: The number of episodes in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">envstep_count</span></code>: The total number of environment interaction steps in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evaluate_time</span></code>: The total time spent on this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avg_envstep_per_episode</span></code>: The average number of environment interaction steps per evaluation episode</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avg_envstep_per_sec</span></code>: The average number of environment interaction steps per second in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">avg_time_per_episode</span></code>: The average time per episode in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_mean</span></code>: The average reward obtained in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_std</span></code>: The standard deviation of rewards in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eval_episode_return</span></code>: The reward value of each episode’s interaction with the environment by the evaluator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_max</span></code>: The maximum reward obtained in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_min</span></code>: The minimum reward obtained in this evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eval_episode_return_mean</span></code>: The average reward obtained in this evaluation</p></li>
</ul>
</section>
<section id="learner-logs">
<h3>Learner Logs<a class="headerlink" href="#learner-logs" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">log/learner/learner_logger.txt</span></code> file records various information about the learner during the model training process, including:</p>
<ul class="simple">
<li><p>Neural network structure: Describes the overall architecture of the MuZero model, including the representation network, dynamics network, prediction network, etc.</p></li>
<li><p>Learner status: Displays the current learning rate, loss function values, optimizer monitoring metrics, etc., in a tabular format:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis/dormant_ratio_encoder_avg</span></code>: The average dormant ratio in the encoder, indicating inactive neurons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis/dormant_ratio_dynamics_avg</span></code>: The average dormant ratio in the dynamics model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis/latent_state_l2_norms_avg</span></code>: The average L2 norm of the latent state</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">collect_mcts_temperature_avg</span></code>: The average temperature parameter of MCTS during data collection, affecting exploration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cur_lr_avg</span></code>: The current learning rate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weighted_total_loss_avg</span></code>: The weighted average total loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_loss_avg</span></code>: The average total loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">policy_loss_avg</span></code>: The average policy loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">policy_entropy_avg</span></code>: The average policy entropy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_policy_entropy_avg</span></code>: The average target policy entropy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reward_loss_avg</span></code>: The average reward loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value_loss_avg</span></code>: The average value loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">consistency_loss_avg</span></code>: The average consistency loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value_priority_avg</span></code>: The average priority based on value in experience replay</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_reward_avg</span></code>: The average target reward</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_value_avg</span></code>: The average target value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predicted_rewards_avg</span></code>: The average predicted rewards</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predicted_values_avg</span></code>: The average predicted values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformed_target_reward_avg</span></code>: The transformed average target reward</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformed_target_value_avg</span></code>: The transformed average target value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_grad_norm_before_clip_avg</span></code>: The total gradient norm before clipping</p></li>
</ul>
</li>
</ul>
</section>
<section id="tensorboard-log-files">
<h3>Tensorboard Log Files<a class="headerlink" href="#tensorboard-log-files" title="Permalink to this heading"></a></h3>
<p>To facilitate experiment management, LightZero saves all scattered log files in the <code class="docutils literal notranslate"><span class="pre">log/serial</span></code> folder as a single Tensorboard log file, named in the format <code class="docutils literal notranslate"><span class="pre">events.out.tfevents.&lt;timestamp&gt;.&lt;hostname&gt;</span></code>. Through Tensorboard, users can monitor the trends of various metrics during the training process in real-time.</p>
</section>
</section>
<section id="checkpoint-files">
<h2>Checkpoint Files<a class="headerlink" href="#checkpoint-files" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ckpt</span></code> folder stores the checkpoint files of the model parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ckpt_best.pth.tar</span></code>: The model parameters that achieved the best performance during evaluation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iteration_&lt;iteration_number&gt;.pth.tar</span></code>: The model parameters periodically saved during the training process</p></li>
</ul>
<p>If you need to load the saved model, you can use methods like <code class="docutils literal notranslate"><span class="pre">torch.load('ckpt_best.pth.tar')</span></code> to read them.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading"></a></h2>
<p>LightZero provides users with a comprehensive logging and monitoring system, helping researchers and developers gain deep insights into the entire training process of reinforcement learning agents. By analyzing the metrics of the collector, evaluator, and learner, we can grasp the progress and effectiveness of the algorithm in real-time and optimize the training strategy accordingly. At the same time, the standardized organization of checkpoint files ensures the reproducibility of experiments. LightZero’s well-developed logging and monitoring system will undoubtedly become a powerful assistant for users in algorithm research and practical applications.</p>
</section>
</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../config/config.html" class="btn btn-neutral float-left" title="How to Set Configuration Files in LightZero" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../api_doc/index.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OpenDILab Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>